<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Entertainment Hub</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
    <style>
        :root {
            --primary-color: #e50914;
            --secondary-color: #564d4d;
            --background-color: #141414;
            --text-color: #ffffff;
            --hover-color: #e5e5e5;
        }

        body {
            background-color: var(--background-color);
            color: var(--text-color);
            font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
        }

        .navbar-brand {
            color: var(--primary-color) !important;
            font-size: 2rem;
            font-weight: bold;
            transition: transform 0.3s ease;
        }

        .navbar-brand:hover {
            transform: scale(1.05);
        }

        .btn-outline-light:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }

        #search-input {
            background-color: rgba(255, 255, 255, 0.2);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        #search-input:focus {
            background-color: rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 10px rgba(229, 9, 20, 0.5);
        }

        #search-input::placeholder {
            color: rgba(255, 255, 255, 0.5);
        }

        .card {
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            overflow: hidden;
            height: 100%;
        }

        .card:hover {
            transform: scale(1.05);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .card-img-wrapper {
            position: relative;
            padding-top: 150%; /* 2:3 aspect ratio */
            overflow: hidden;
        }

        .card-img-top {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .card:hover .card-img-top {
            transform: scale(1.1);
        }

        .card-body {
            background-color: rgba(0, 0, 0, 0.7);
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            transform: translateY(100%);
            transition: transform 0.3s ease;
        }

        .card:hover .card-body {
            transform: translateY(0);
        }

        #player-container {
            aspect-ratio: 16 / 9;
        }

        #player-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        .pagination {
            transition: opacity 0.3s ease;
        }

        .page-link {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
            color: var(--text-color);
            transition: all 0.3s ease;
        }

        .page-link:hover {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand animate__animated animate__fadeIn" href="#">Entertainment Hub</a>
            <div class="btn-group animate__animated animate__fadeIn" role="group" aria-label="Media Type">
                <button type="button" class="btn btn-outline-light active" id="movie-button">Movies</button>
                <button type="button" class="btn btn-outline-light" id="tv-button">TV Shows</button>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <div class="row mb-4">
            <div class="col">
                <div class="input-group animate__animated animate__fadeIn">
                    <input type="text" id="search-input" class="form-control" placeholder="Search for a movie or TV show">
                    <button class="btn btn-primary" type="button" id="search-button">Search</button>
                </div>
            </div>
        </div>

        <div id="player-container" class="mb-4 d-none animate__animated animate__fadeIn"></div>
        <button id="back-button" class="btn btn-secondary mb-4 d-none animate__animated animate__fadeIn">Back to Search</button>

        <div id="results" class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4"></div>

        <nav aria-label="Page navigation" class="mt-4">
            <ul class="pagination justify-content-center d-none animate__animated animate__fadeIn" id="pagination">
                <li class="page-item">
                    <button class="page-link" id="prev-page" aria-label="Previous">
                        <span aria-hidden="true">&laquo;</span>
                    </button>
                </li>
                <li class="page-item"><span class="page-link" id="current-page"></span></li>
                <li class="page-item">
                    <button class="page-link" id="next-page" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </button>
                </li>
            </ul>
        </nav>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const API_KEY = '6b1e21c238152148b72e0776bc1073b3';
        let mediaType = 'movie';
        let currentPage = 1;
        let totalPages = 0;

        $(document).ready(function() {
            $('#movie-button').click(() => setMediaType('movie'));
            $('#tv-button').click(() => setMediaType('tv'));
            $('#search-button').click(() => search(1));
            $('#back-button').click(resetSearch);
            $('#prev-page').click(() => search(currentPage - 1));
            $('#next-page').click(() => search(currentPage + 1));
            $('#search-input').keypress((e) => {
                if (e.which === 13) search(1);
            });
        });

        function setMediaType(type) {
            mediaType = type;
            $('#search-input').attr('placeholder', `Search for a ${mediaType === 'movie' ? 'Movie' : 'TV Show'}`);
            $('#movie-button, #tv-button').removeClass('active');
            $(`#${type}-button`).addClass('active');
            resetSearch();
        }

        async function search(page) {
            const query = $('#search-input').val().trim();
            if (!query) return;

            try {
                const response = await $.getJSON(
                    `https://api.themoviedb.org/3/search/${mediaType}?query=${encodeURIComponent(query)}&api_key=${API_KEY}&page=${page}`
                );
                displayResults(response.results);
                totalPages = response.total_pages;
                currentPage = page;
                updatePagination();
            } catch (error) {
                console.error('Error fetching data:', error);
                alert('An error occurred while searching. Please try again later.');
            }
        }

        function displayResults(results) {
            const $results = $('#results').empty();
            results.forEach(result => {
                const $resultItem = $('<div class="col">').append(
                    $('<div class="card h-100 bg-dark animate__animated animate__fadeIn">').append(
                        $('<div class="card-img-wrapper">').append(
                            $('<img>').addClass('card-img-top')
                                .attr('src', result.poster_path ? `https://image.tmdb.org/t/p/w500${result.poster_path}` : 'https://via.placeholder.com/500x750.png?text=No+Image')
                                .attr('alt', result.title || result.name)
                        ),
                        $('<div class="card-body">').append(
                            $('<h5 class="card-title">').text(result.title || result.name),
                            $('<p class="card-text">').text(result.release_date || result.first_air_date || 'N/A')
                        )
                    ).click(() => playContent(result.id))
                );
                $results.append($resultItem);
            });
            $('#results').removeClass('d-none');
            updatePaginationVisibility();
        }

        function playContent(id) {
            $('#player-container').html(`
                <iframe src="https://vidsrc.xyz/embed/${mediaType}/${id}" allowfullscreen></iframe>
            `).removeClass('d-none').addClass('animate__animated animate__fadeIn');
            $('#results, #pagination').addClass('d-none');
            $('#back-button').removeClass('d-none').addClass('animate__animated animate__fadeIn');
            $('html, body').animate({ scrollTop: 0 }, 'slow');

            // Set up ad blocker
            const iframe = $('#player-container iframe')[0];
            iframe.onload = () => {
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        if (mutation.type === 'childList') {
                            removeAds(mutation.target);
                        }
                    });
                });

                const removeAds = (element) => {
                    const adSelectors = [
                        'div[id^="adb"]',
                        'div[class*="ad-"]',
                        'iframe[src*="ads"]',
                        '.video-ads',
                        '#player-ads'
                    ];

                    adSelectors.forEach(selector => {
                        $(element).find(selector).remove();
                    });
                };

                observer.observe(iframe.contentDocument.body, {
                    childList: true,
                    subtree: true
                });
            };
        }

        function resetSearch() {
            $('#search-input').val('');
            $('#results').empty();
            $('#player-container').empty().addClass('d-none');
            $('#results').removeClass('d-none');
            $('#back-button').addClass('d-none');
            currentPage = 1;
            totalPages = 0;
            updatePaginationVisibility();
        }

        function updatePagination() {
            $('#current-page').text(`Page ${currentPage} of ${totalPages}`);
            $('#prev-page').prop('disabled', currentPage === 1);
            $('#next-page').prop('disabled', currentPage === totalPages);
        }

        function updatePaginationVisibility() {
            if (totalPages > 1) {
                $('#pagination').removeClass('d-none').addClass('animate__animated animate__fadeIn');
            } else {
                $('#pagination').addClass('d-none');
            }
        }
    </script>
</body>
</html>