Lab-19

CREATE TABLE Person (
    PersonID INT PRIMARY KEY,
    PersonName VARCHAR(100) NOT NULL,
    DepartmentID INT,
    Salary DECIMAL(8,2) NOT NULL,
    JoiningDate DATETIME NOT NULL,
    City VARCHAR(100) NOT NULL,
    FOREIGN KEY (DepartmentID) REFERENCES Department(DepartmentID)
);

INSERT INTO Person (PersonID, PersonName, DepartmentID, Salary, JoiningDate, City)
VALUES
(101, 'Rahul Tripathi', 2, 56000.00, '2000-01-01', 'Rajkot'),
(102, 'Hardik Pandya', 3, 18000.00, '2001-09-25', 'Ahmedabad'),
(103, 'Bhavin Kanani', 4, 25000.00, '2000-05-14', 'Baroda'),
(104, 'Bhoomi Vaishnav', 1, 39000.00, '2005-02-08', 'Rajkot'),
(105, 'Rohit Topiya', 2, 17000.00, '2001-07-23', 'Jamnagar'),
(106, 'Priya Menpara', NULL, 9000.00, '2000-10-18', 'Ahmedabad'),
(107, 'Neha Sharma', 2, 34000.00, '2002-12-25', 'Rajkot'),
(108, 'Nayan Goswami', 3, 25000.00, '2001-07-01', 'Rajkot'),
(109, 'Mehul Bhundiya', 4, 13500.00, '2005-01-09', 'Baroda'),
(110, 'Mohit Maru', 5, 14000.00, '2000-05-25', 'Jamnagar');

CREATE TABLE Department (
    DepartmentID INT PRIMARY KEY,
    DepartmentName VARCHAR(100) NOT NULL UNIQUE,
    DepartmentCode VARCHAR(50) NOT NULL UNIQUE,
    Location VARCHAR(50) NOT NULL
);

INSERT INTO Department (DepartmentID, DepartmentName, DepartmentCode, Location)
VALUES
(1,'Admin','Adm','A-Block'),
(2,'Computer','CE','C-Block'),
(3,'Civil','CI','G-Block'),
(4,'Electrical','EE','E-Block'),
(5,'Mechanical','ME','B-Block');


Part-A

1) SELECT Person.PersonName, Department.DepartmentName, Department.DepartmentCode
FROM Person
LEFT JOIN Department ON Person.DepartmentID = Department.DepartmentID;

2) SELECT Department.DepartmentName, MAX(Person.Salary) AS MaximumSalary, MIN(Person.Salary) AS MinimumSalary
FROM Person
LEFT JOIN Department ON Person.DepartmentID = Department.DepartmentID
GROUP BY Department.DepartmentName;

3) SELECT Department.DepartmentName, SUM(Person.Salary) AS TotalSalary
FROM Person
LEFT JOIN Department ON Person.DepartmentID = Department.DepartmentID
GROUP BY Department.DepartmentName
HAVING SUM(Person.Salary) > 100000;

4) SELECT Person.PersonName, Person.Salary, Department.DepartmentName
FROM Person
LEFT JOIN Department ON Person.DepartmentID = Department.DepartmentID
WHERE City = 'Jamnagar';

5) SELECT *
FROM Person
WHERE DepartmentID IS NULL;



Part-B

1) SELECT Department.DepartmentName, COUNT(Person.PersonID) AS PersonCount
FROM Department
LEFT JOIN Person ON Department.DepartmentID = Person.DepartmentID
GROUP BY Department.DepartmentName;

2) SELECT AVG(Salary) AS AverageSalary
FROM Person
WHERE City = 'Ahmedabad';

3) SELECT CONCAT(Person.PersonName, ' earns ', Person.Salary, ' from department ', Department.DepartmentName, ' monthly.') AS Output
FROM Person
LEFT JOIN Department ON Person.DepartmentID = Department.DepartmentID;

4) SELECT *
FROM Department
WHERE DepartmentID NOT IN (SELECT DISTINCT DepartmentID FROM Person);

5) SELECT City, Department.DepartmentName, SUM(Salary) AS TotalSalary, AVG(Salary) AS AverageSalary, MAX(Salary) AS MaximumSalary
FROM Person
LEFT JOIN Department ON Person.DepartmentID = Department.DepartmentID
GROUP BY City, Department.DepartmentName;



Part-C

1) SELECT DISTINCT City
FROM Person;

2) SELECT Department.DepartmentName
FROM Department
LEFT JOIN Person ON Department.DepartmentID = Person.DepartmentID
GROUP BY Department.DepartmentName
HAVING COUNT(Person.PersonID) > 2;

3) SELECT CONCAT(LEFT(Person.PersonName, 3), RIGHT(City, 3)) AS CombinedName
FROM Person;

4) UPDATE Person
SET Salary = Salary * 1.1
WHERE DepartmentID = 2;

5) SELECT PersonName
FROM Person
WHERE DATEDIFF(CURDATE(), JoiningDate) > 365;
